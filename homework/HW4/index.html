---
layout: default
title: Homework 4
---
  <h1>Homework 4</h1>
  
  <h2>Due ___________ before or at the start of class.</h2>

  <br/>
  
  <p><b>Problem 1</b></p>
  
  <p>
   Download the datafile cascades_swe (.xlsx).
  </p>

<i>
  <table>
    <tr>
      <td>Data:</td>
      <td>  
        <ul>
          <li><a href="https://moorec52.github.io/water-data-analysis.github.io/homework/HW4/cascades_swe.xlsx">cascades_swe.xlsx</a></li>
        </ul>
      </td>
    </table>
  </i>

  <p>
    The data in the first three columns are values for total precipitation (mm), daily
    maximum temperature (&degC), and daily minimum temperature (&degC) averaged from
    October-March over the Pacific Northwest Cascades in WA in OR. The fourth column is
    an estimate of April 1 snow water equivalent (in mm, the water content of the snowpack)
    from model simulations, averaged over the same domain.
  </p>
    
  <ol type='A'>
  
    <li>
        Calculate the long-term trend in April 1 SWE from 1916-2003 by fitting a linear
        model to the data. Estimate the uncertainty in the trend by evaluating a 95%
        confidence interval around the estimate of B1. That is:
        <br/>
      <i>Trend</i> = X &plusmn Y
        <br/>
        Is the trend statistically significant with 95% confidence? I.e. can we reject the
        null hypothesis that the trend is equal to zero?
    </li>
    
    <li>
        Repeat this analysis for only the more recent period 1950-2003.
    </li>
    
  </ol>
  
<br/>
  
  <p><b>Problem 2</b></p>
  
  <p>
    Continue using the cascades_swe dataset for this problem. Begin by pasting in your
    scatterplots for these variables from the first homework.
  </p>

    
  <ol type='A'>
  
    <li>
        Calculate the correlation (R) between April 1 SWE and the three meteorological
        variables (precipitation, max. temperature and min. temperature), and also between all
        unique combinations of the meteorological variables.
    </li>
        
    <li>
        Calculate the autocorrelation in precipitation, maximum temperature and minimum
        temperature. Can we consider each of these values to be an independent sample? Or
        do some of them depend on the prior year’s sample? [Note: We can test for
        autocorrelation at different lags, but not for any lag longer than a quarter of the length of
        the data series. Therefore, test for lags from 1 to N/4, where N is the length of the data
        series. Determine at which of these lags the autocorrelation is different than 0 with 95%
        confidence.]
    </li>
    
    <li>
        Fit a multiple linear regression model to the data, using all three meteorological
        variables to predict April 1 SWE.  Also calculate the trend in each meteorological
        variable.  Estimate the overall trend in SWE, and trend due to each meteorological
        variable alone.  How much of the overall trend is due to the combined effects of trends
        in both tmax and tmin?
    </li>
    
    <li>
        Finally carry out a Mann-Kendall test on the 1950-2003 April 1 SWE data.  Is the
        trend significant according to this test?  Compare your answer with your regression
        analysis for the same data in Problem 2B. [Note, for this problem you do not need to
        worry about the tie statistic.]
    </li>
    
  </ol>

<br/>
  
  <p><b>Problem 3: Calculating a Rating Curve and Associated Uncertainty</b></p>
  
  <p>
    Download Tuolumne_120_stage_Q_2002_2018_forclass.csv. Make a scatter plot of stage (in cm) vs. discharge (in cms). You
    may want to look at Venetis_1970.pdf.
</p>

<i>
  <table>
    <tr>
      <td>Data:</td>
      <td>  
        <ul>
          <li><a href="https://moorec52.github.io/water-data-analysis.github.io/homework/HW4/Tuolumne_120_stage_Q_2002_2018_forclass.csv">Tuolumne_120_stage_Q_2002_2018_forclass.csv</a></li>
        </ul>
      </td>
    </table>
  </i>
    
<p>
    Plot the data, assume that h<sub>0</sub> =70 cm, the stage height at which flow stops. This is a
    guess, but for now, we’ll assume this is truth. Use linear regression with transformed
    variables to fit an equation of the form Q=a(h-h<sub>0</sub>)<sup>b</sup> to the data, to determine a and b,
    where Q is discharge in cms, and h is stage in cm. Determine 95% confidence intervals
    for b (note this corresponds to B<sub>1</sub> in class lecture) and for log(Q). Transform the mean,
    upper, and lower confidence intervals for log(Q) back to Q, and plot the rating curve with
    confidence intervals and the original data.
    
    <br/><br/>
    
    Now, assume that we don’t know at what level flow stops. Repeat the above for h<sub>0</sub> = 60,
    65, 70, 75, and 80 cm. Recalculate a, b, log(Q), and Q for each of these. Don’t worry
    about 95% uncertainty in this example. Make a plot showing stage (h) vs. Q for each of
    these 5 cases. Is the range between these 5 lines larger or smaller than the range
    between the 95% confidence lines that you generated before? Note that we did not
    explicitly account for uncertainty in h 0 in generating those 95% confidence lines. Based
    on what you have plotted here, is that an okay thing to do or not?
    
    <br/><br/>
    
    The data provided in the file also have uncertainty associated with them. Describe in a
    couple sentences how you would account for this uncertainty. (Note that you do not
    need to do more calculations. Just write a couple sentences about things you might
    do.)
  </p>
 
